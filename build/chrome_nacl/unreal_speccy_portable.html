<!DOCTYPE html>
<html>
<head>
  <title>Unreal Speccy Portable</title>

  <script type="text/javascript">
    module = null;
    statusText = 'unknown';

    function moduleDidLoad()
    {
      module = document.getElementById('unreal_speccy_portable');
      updateStatus('module_ok');
    }

    // Handle a message coming from the NaCl module.
    function handleMessage(m)
    {
		updateStatus(m.data);
    	if(m.data == 'resources_ok')
    		module.postMessage('run');
    }

    function pageDidLoad()
    {
      if(module == null)
        updateStatus('loading...');
      else
        updateStatus();
    }

	function onOpen()
	{
	    var image_name = document.getElementById("image_name");
	    var value = image_name.children[image_name.selectedIndex].value;
	    module.postMessage('open:' + value);
	}
	function onReset()
	{
		module.postMessage('reset');
	}

    function updateStatus(opt_message)
    {
      if(opt_message)
        statusText = opt_message;
      var status = document.getElementById('status');
      if(status)
      {
        status.innerHTML = statusText;
      }
    }
  </script>
</head>
<body onload="pageDidLoad()">

<p>
  <div id="listener">
    <script type="text/javascript">
      var listener = document.getElementById('listener')
      listener.addEventListener('load', moduleDidLoad, true);
      listener.addEventListener('message', handleMessage, true);
    </script>

    <embed name="nacl_module"
           id="unreal_speccy_portable"
           width=640 height=480
           src="unreal_speccy_portable.nmf"
           type="application/x-nacl" />
  </div>
  <div id="selector">
	<select id="image_name">
        <option value="_EXOLON.SNA">Exolon</option>
        <option value="ADVENT6.TRD">Adventurer 6</option>
        <option value="BORN_0F.ZIP">Born Dead 0F</option>
        <option value="BORN_10.ZIP">Born Dead 10</option>
        <option value="ZX-FORM4.ZIP">ZX-Format 4</option>
        <option value="ZXFORM7O.ZIP">ZX-Format 7</option>
        <option value="EYEACHE-.SCL">Eye Ache</option>
        <option value="EYEACHE2.TRD">Eye Ache 2</option>
        <option value="SHOCKPEN.ZIP">Shock for Pentagon</option>
        <option value="SP17.TRD">Spectrophon 17</option>
        <option value="illusion_test.sna">Illusion</option>
	</select>
	<button onclick="onOpen()">Open</button>
	<button onclick="onReset()">Reset</button>
  </div>
</p>
<div id="status"></div>
</body>
</html>
